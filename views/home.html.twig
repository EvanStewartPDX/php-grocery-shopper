<!DOCTYPE html>
<html>

    <body>
        <div class="container">
            <nav class="navbar navbar-default">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#nav" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/"><span class="glyphicon glyphicon-home"></span> Home</a>
                    </div>
                    <div class="collapse navbar-collapse" id="nav">
                        <ul class="nav navbar-nav navbar-right">
                            <li>
                                <form class="form-inline navbar-form" action='/patron' method='post'>
                                    <div class="form-group">
                                        <input type="text" class="form-control" placeholder="New username" name='username'>
                                    </div>
                                    <button type="submit" class="btn btn-default">Sign Up</button>
                                </form>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Login <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <form class="form-inline navbar-form" action='/patron/login' method='post'>
                                            <div class="form-group">
                                                <input type="text" class="form-control" placeholder="Username" name='username'>
                                            </div>
                                            <button type="submit" class="btn btn-default">Go</button>
                                        </form>
                                    </li>
                                    <li><a href="/products">Admin View</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <br>
            <div class="jumbotron text-center">
                <h1>Shoppr</h1>
            </div>

            <!-- <a href="/products">Enter / Modify Products</a> -->

            <div class="row">
                <div class="col-sm-2 well">

                    <form action='/search_products' method='post'>
                        <div class="form-group input-group">
                            <input type="text" class="form-control" placeholder="Search" name='search_input'>
                            <span class="input-group-btn"><button type="submit" class="btn btn-default"><span class='glyphicon glyphicon-search'></span></button></span>
                        </div>
                    </form>
                    <button class="btn-btn-info"><a href="/">Clear Filters</a></button>

                    <h4>Click to choose a category:</h4>
                    {% if categories is not empty %}
                    <ul>
                        {% for category in categories %}
                            <li><a href="/category/{{ category.getId }}">{{ category.getName }}</a></li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>

                <div class="col-sm-8">
                    {% if products is not empty %}
                        <div class="row">
                            {% if category is empty %}
                                {% for product in products %}
                                    <div class="col-sm-3 panel">
                                        <div class="panel-body">
                                            <img src="/uploads/{{ product.getPhoto }}" alt="Card image cap">
                                            <h4>{{ product.getName }}</h4>
                                            <p>Price per - ${{ product.getPrice }}</p>
                                            <p>{{ product.getInventory }} in stock</p>
                                            <form class="" action="/addToCart" method="post">
                                                <div class='form-group'>
                                                    <label>Purchase quantity:</label>
                                                    <input type="number" name="purchase_quantity" min=0 max='{{product.getInventory}}' class='form-control' required>
                                                    <input type="hidden" name="product_id" value="{{product.getId}}">
                                                </div>
                                                <button class="btn btn-info" type="submit" class="btn btn-primary">Add to cart!</button>
                                            </form>
                                        </div>
                                    </div>
                                {% endfor %}

                            {% else %}
                                {% for product in categoryProducts %}
                                    <div class="col-sm-3 panel">
                                        <div class="panel-body">
                                            <img src="/uploads/{{ product.getPhoto }}" alt="Card image cap">
                                            <h4>{{ product.getName }}</h4>
                                            <p>Price per - ${{ product.getPrice }}</p>
                                            <p>{{ product.getInventory }} in stock</p>
                                            <form class="" action="/order/{{ product.getId }}" method="post">
                                                <div class='form-group'>
                                                    <label>Purchase quantity:</label>
                                                    <input type="number" name="purchase_quantity" min=0 max='{{product.getInventory}}' class='form-control'>
                                                    <input type="hidden" name="product_id" value="{{product.getId}}">
                                                </div>
                                                <button class="btn btn-info" type="submit" class="btn btn-primary">Add to cart!</button>
                                            </form>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}
                        </div>

                    {% else %}
                        <h5>Sorry ... no known inventory! D-:</h5>
                    {% endif %}
                </div>
                <!-- cart area -->
                <div class="col-sm-2">
                    <form class="" action="/cart" method="post">
                        <label for="">Make New Shopping Cart</label>
                        <button class="btn btn-success" type="submit" name="button">Start <span class="glyphicon glyphicon-shopping-cart"></span></button>
                    </form>
                    {% if order is not empty %}
                    <ul>
                        {% for product in order.getCart %}
                        <li>{{product.getName}} cost: ${{product.calculateProductPrice}}</li>
                        <li>{{product.getPurchaseQuantity}}@ ${{product.getPrice}} each
                        <form class="trash" action="/deleteProductFromCart" method="post">
                            <input type="hidden" name="_method" value="delete">
                            <input type="hidden" name="product_id" value="{{product.getId}}">
                            <button class=" btn-danger btn-xs" type="submit" name="button">
                                <span class= "glyphicon glyphicon-trash"></span></button>
                        </form></li>
                        {% endfor %}
                    </ul>
                    <p><strong>Total:</strong> ${{order.getTotal}}0</p>


                    {% endif %}
                </div>

            </div>

        </div>
    </body>
<!-- </html> -->
